---
title: 部署 teedoc 生成的网站到 CDN
keywords: teedoc, 部署, CDN
desc: teedoc 生成的网站部署到 CDN
---




为了让各个地方的用户访问站点更加快速，可以使用 CDN 加速，
原理简单介绍就是先把网站放在一个源服务器上， 然后将这个资源同步到全国甚至全世界各地的节点上，
浏览器想要通过域名访问网站，这个域名指向的服务器只做一件事情，就是解析浏览器的地点，然后返回给给浏览器离浏览器最近的节点 IP 地址，然后浏览器直接访问最近的节点，从而实现了加速


先找一个 `CDN` 提供商，比如 阿里云 腾讯云 七牛云 都可以

然后步骤如下：

## 创建源服务器

### 方法一：上传文件到服务商的储存桶（服务器）

直接使用这些服务商的空间（可以看做是一个服务器）， 一般都有免费额度，直接上传这个网站到服务商的空间里面，服务商会分配一个临时域名，启用 `CDN` 就可以直接访问了，很简单。

但是上传文件需要使用服务商提供的指定工具，不能使用通用的工具（如`scp`）。

`teedoc`提供了`teedoc-upload`工具用于上传到常见的服务器，目前只支持七牛云，欢迎 PR 或者直接用服务商的工具上传。
```
teedoc-upload --cloud qiniu --bucket my-bucket --access_key ******** --secret_key ****  ./out
```

另外此工具也提供了只上传和上一次不同内容不同的文件，前提是需要将上次的`out`目录保留起来
```
teedoc-upload --cloud qiniu --bucket my-bucket --access_key ******** --secret_key **** --old ./old_out ./out
```

另外这些储存桶可能会有一些问题，比如七牛云不能支持不带`html`结尾的链接，比如`/test`不能自动转到`/test.html`，以及默认没有打开访问`/`自动转到`/index.html`，以及`404.html`不能直接从储存桶里面读取，需要手工上传到七牛云的配置里面，总之体验非常糟糕，所以这种方式用起来本来理论上最简单粗暴自己不用搭服务器而且和CDN 是同一家服务，比较方便，但是却有这些没做好的地方，也许未来解决了这几个问题就好用了（编辑于2022-09-05），像 github 的pages 服务就没这些问题，就是国内访问慢或者访问不了，或者尝试下其它云。


### 方法二：自己创建一个源服务器（源网站）

自己创建源服务器，源服务器更新后，服务商自动同步更新到各个节点

按照前面的方法建立一个网站 ，得到`域名A`， 比如`teedoc.github.io`


## 为网站添加 CDN 加速

如果是中国国内的服务商，需要先有一个备案的`域名B`，然后注册登录，添加一个 `CDN`服务， 设置回源站点为前面建立的网站`域名A`即可

然后访问`域名B`，服务商会自动从`域名A`出拉取网页同步到全国或者全球的各个节点，然后用户访问`域名B`就会重定向到离用户最近的节点的`IP`，以保证最快的浏览速度

